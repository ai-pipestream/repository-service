name: Release and Publish

on:
  workflow_dispatch:
    inputs:
      release_type:
        description: 'Release type (patch, minor, major, or manual)'
        required: true
        default: 'patch'
        type: choice
        options:
          - patch
          - minor
          - major
          - manual
      custom_version:
        description: 'Custom version (only for manual release type, e.g., 1.0.0)'
        required: false
        type: string

jobs:
  release-and-publish:
    uses: ai-pipestream/.github/.github/workflows/reusable-service-release.yml@main
    with:
      release_type: ${{ inputs.release_type }}
      custom_version: ${{ inputs.custom_version }}
      docker-image-name: repository-service
      maven-artifact-id: repository-service
      dockerfile-path: src/main/docker/Dockerfile.jvm
    secrets: inherit
